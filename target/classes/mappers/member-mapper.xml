<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Member">
	<resultMap type="Member" id="memberResultSet">

		<id property="mid" column="MID"/>
		<result property="email" column="EMAIL"/>
		<result property="user_pwd" column="USER_PWD"/>
		<result property="user_name" column="USER_NAME"/>
		<result property="birthday" column="BIRTHDAY"/>
		<result property="gender" column="GENDER"/>
		<result property="phone" column="PHONE"/>
		<result property="user_class" column="USER_CLASS"/>
		<result property="status" column="STATUS"/>
		<result property="login_class" column="LOGIN_CLASS"/>
		<result property="blacklist_status" column="BLACKLIST_STATUS"/>
		<result property="join_date" column="JOIN_DATE"/>
		<result property="withdraw_date" column="WITHDRAW_DATE"/>
		<result property="nickname" column="NICKNAME"/>
	</resultMap>
	   
	 <!--  로그인 정보 조회용 쿼리문  / 고성희 -->
	<select id="loginCheck" resultMap="memberResultSet" parameterType="Member">
		SELECT * 
		FROM MEMBER 
		WHERE EMAIL = #{email} 
		AND USER_PWD = #{user_pwd} 
		AND STATUS = 'N'
	</select>
	
	<!-- 회원 가입용 메소드 / 황이주 -->
	<insert id="insertMember" parameterType="Member">
		INSERT INTO MEMBER
		VALUES('M' || MEMBER_MID.NEXTVAL, #{email}, #{user_pwd}, #{user_name},
				#{birthday}, #{gender}, #{phone}, 'BUYER', DEFAULT,
				'GENERAL', 'N', SYSDATE, NULL,
				#{nickname})		   
	</insert>
	
	<!-- 암호화된 비밀번호 조회용 메소드 / 고성희 -->
	<select id="selectPwd" resultType="java.lang.String" parameterType="java.lang.String">
		SELECT USER_PWD
		FROM MEMBER
		WHERE EMAIL = #{email}
		AND STATUS = 'N'
	</select>
	
	<!-- 비밀번호 일치 시 회원 정보 조회용 쿼리문 -->
	<select id="selectLoginUser" resultMap="memberResultSet" parameterType="Member">
		SELECT *
		FROM MEMBER

		WHERE EMAIL = #{email}

		AND STATUS = 'N'
	</select>
	
	<!-- 닉네임 중복 체크 -->
	<select id="checkNick" parameterType="Member" resultType="java.lang.String">
    SELECT NVL(COUNT(*),0)
    FROM MEMBER 
    WHERE NICKNAME = ${nickname}
	</select>
	
	
</mapper>