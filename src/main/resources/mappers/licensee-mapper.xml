<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Licensee">
	<resultMap type="MovieRoom" id="movieRoomResultSet">
		<id property="movieRoomId" column="MOVIEROOM_ID"/>
		<result property="theaterId" column="THEATER_ID"/>
		<result property="movieRoomName" column="MOVIEROOM_NAME"/>
		<result property="movieRoomAddress" column="MOVIEROOM_ADDRESS"/>
	
	</resultMap>
	
		<resultMap type="BoardFile" id="SearchBoardFileSet">
		<id property="file_id" column="FILE_ID" />
		<result property="board_id" column="BOARD_ID" />
		<result property="origin_name" column="ORIGIN_NAME" />
		<result property="edit_name" column="EDIT_NAME" />
		<result property="file_src" column="FILE_SRC" />
		<result property="file_date" column="FILE_DATE" />
		<result property="file_level" column="FILE_LEVEL" />
	</resultMap>
	
		<resultMap type="Play" id="PlayResultSet">
		
		<id property="play_id" column="PLAY_ID"/>
		<result property="movie_id" column="MOVIE_ID"/>
		<result property="movieRoom_id" column="MOVIEROOM_ID"/>
		<result property="play_status" column="PLAY_STATUS"/>
		
		</resultMap>
		
		<resultMap type="Turning" id="TurningResultSet">
		
		<id property="turning_id" column="TURNING_ID"/>
		<result property="play_id" column="PLAY_ID"/>
		<result property="price" column="PRICE"/>
		<result property="turning_day" column="TURNING_DAY"/>
		<result property="turning_time" column="TURNING_TIME"/>
		<result property="start_time" column="START_TIME"/>
		<result property="end_time" column="END_TIME"/>

		</resultMap>
	
<!-- 상영관 추가하기~!~!~!~!~! -->
<insert id="insertMovieRoom" parameterType="MovieRoom">
		INSERT INTO MOVIEROOM VALUES ('MR' || TO_CHAR(MOVIEROOM_MOVIEROOM_ID.NEXTVAL),
		(SELECT THEATER_ID FROM THEATER
		WHERE MID = #{mid}), #{movieRoomName}, #{movieRoomAddress})
	</insert>
	
<!-- movieRoomId 값 가져오기 -->
<select id="selectIdCheck" resultMap="movieRoomResultSet" parameterType="MovieRoom">
	SELECT MOVIEROOM_ID 
	FROM(SELECT ROWNUM RNUM, MOVIEROOM_ID FROM MOVIEROOM
	ORDER BY MOVIEROOM_ID DESC)
	WHERE RNUM = 1
</select>

<!-- 정태 영화관 사진 파일 추가 -->
<insert id="insertFile" parameterType="BoardFile">
	INSERT INTO BOARD_FILE
		VALUES('BF' ||
		BOARD_FILE_FILE_ID.NEXTVAL,#{board_id},#{origin_name},
		#{edit_name},#{file_src},SYSDATE,#{file_level})
</insert>

<!-- 정태 영화관 사진 파일 수정 -->
<!-- <update id="updateFile">
	UPDATE BOARD_FILE
	SET FILE_LEVEL=0
	<choose>
		<when test="file_level == 1">
		WHERE FILE_LEVEL=1
		</when>
		<when test="file_level == 2">
		WHERE FILE_LEVEL=2
		</when>
	</choose>
</update> -->
<!-- 영화관 사진 보기 -->
<select id="selectFile" resultMap="SearchBoardFileSet">
		SELECT *
		FROM BOARD_FILE
		WHERE
		FILE_LEVEL=1 OR FILE_LEVEL = 2
		ORDER BY FILE_LEVEL
	</select>
	
	
	
	
	
	
	
	

</mapper>